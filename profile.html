<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configurações do Perfil - David's Farm</title>
    <link rel="stylesheet" href="style.css">
    
        <link rel="icon" href="/imgs/siteLogo.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/imgs/siteLogo.ico" type="image/x-icon">
</head>
<body>
    <div id="background-particles"></div>
    <div id="site-content">
        <header>
            <div class="header-left">
                <a href="index.html" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
                    <img src="imgs/logo.svg" alt="Logo David's Farm" id="logo">
                    <h1>David's Farm</h1>
                </a>
            </div>
            <div class="user-auth-section">
                </div>
        </header>
        <main>
            <div class="profile-container">
                <aside class="profile-menu">
                    <ul>
                        <li><button id="tab-perfil" class="active">Meu Perfil</button></li>
                        <li><button id="tab-seguranca">Segurança</button></li>
                        <li><button id="tab-tema">Tema</button></li>
                        <li><button id="tab-jogos">Jogos</button></li>
                        <li><a href="friends.html" class="profile-menu-link-button">Amigos</a></li>
                    </ul>
                </aside>
                <section class="profile-content">
                    <div id="section-perfil" class="profile-section active">
                        <div class="section-header">
                            <h2>Meu Perfil</h2>
                            <button id="view-public-profile-button" class="view-profile-btn">Visualizar Perfil Público</button>
                        </div>
                        <form id="profile-form">
                            <div class="form-group">
                                <label for="profile-username">Nome de Usuário (Apelido):</label>
                                <input type="text" id="profile-username" name="username">
                            </div>
                            <div class="form-group">
                                <label for="profile-photo-url-input">URL da Foto de Perfil:</label>
                                <input type="url" id="profile-photo-url-input" name="photoURL" placeholder="https://exemplo.com/sua-foto.jpg">
                                <div class="photo-preview-container" style="margin-top:10px;">
                                    <img id="profile-photo-preview-img" src="imgs/default-avatar.png" alt="Pré-visualização da foto">
                                    <small>Pré-visualização</small>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="profile-scratch-username">Nome de Usuário no Scratch:</label>
                                <input type="text" id="profile-scratch-username" name="scratchUsername" placeholder="ex: griffpatch">
                            </div>
                            <div class="form-group">
                                <label for="profile-pronouns">Pronomes:</label>
                                <input type="text" id="profile-pronouns" name="pronouns" placeholder="ex: Ele/Dele, Ela/Dela, Elu/Delu">
                            </div>
                            <div class="form-group">
                                <label for="profile-description">Descrição do Perfil (Bio):</label>
                                <textarea id="profile-description" name="profileDescription" rows="5" placeholder="Conte um pouco sobre você..."></textarea>
                            </div>
                            <button type="submit">Salvar Alterações do Perfil</button>
                        </form>
                        <div id="profile-message" class="form-message"></div>

                        <hr style="margin: 30px 0; border-color: #444;">
                        <div class="account-actions">
                            <h3>Gerenciar Conta</h3>
                            <button id="logout-button-profile-page" class="account-action-button">Sair da conta</button>
                            <button id="delete-account-button" class="account-action-button delete">Deletar conta</button>
                            <div id="account-action-message" class="form-message"></div>
                        </div>
                    </div>

                    <div id="section-seguranca" class="profile-section">
                        <h2>Segurança da Conta</h2>
                        <form id="change-password-form">
                            <h3 id="password-form-title">Alterar Senha</h3>
                            <div class="form-group" id="current-password-group">
                                <label for="current-password">Senha Atual:</label>
                                <input type="password" id="current-password" name="currentPassword">
                            </div>
                            <div class="form-group">
                                <label for="new-password" id="new-password-label">Nova Senha:</label>
                                <input type="password" id="new-password" name="newPassword" required>
                            </div>
                            <div class="form-group">
                                <label for="confirm-new-password">Confirmar Nova Senha:</label>
                                <input type="password" id="confirm-new-password" name="confirmNewPassword" required>
                            </div>
                            <button type="submit" id="password-submit-button">Alterar Senha</button>
                        </form>
                        <div id="password-message" class="form-message"></div>

                        <hr style="margin: 30px 0; border-color: #444;">

                        <form id="change-email-form">
                            <h3>Alterar Email</h3>
                            <p>Seu email atual: <strong id="current-email-display">carregando...</strong></p>
                                <div class="form-group">
                                    <label for="email-current-password">Senha Atual (para confirmar alteração de email):</label>
                                    <input type="password" id="email-current-password" name="emailCurrentPassword" required>
                                </div>
                            <div class="form-group">
                                <label for="new-email">Novo Email:</label>
                                <input type="email" id="new-email" name="newEmail">
                            </div>
                            <button type="submit">Alterar Email</button>
                        </form>
                        <div id="email-message" class="form-message"></div>
                    </div>

                    <div id="section-tema" class="profile-section">
                        <h2>Tema do Perfil</h2>
                        <p>Personalize a aparência do seu perfil público.</p>
                        <div class="theme-options-container">
                            <button id="btn-theme-profile" class="theme-option-button">
                                <img src="imgs/temadoperfil.png" alt="Tema do Perfil Icon" class="theme-button-icon"> Tema do Perfil
                            </button>
                            <button id="btn-theme-site" class="theme-option-button" disabled>
                                <img src="imgs/temadosite.png" alt="Tema do Site Icon" class="theme-button-icon"> Tema do Site (Em Breve)
                            </button>
                        </div>
                        <div id="theme-message" class="form-message"></div>

                        <div class="profile-theme-preview-container">
                            <h3>Pré-visualização do Perfil:</h3>
                            <div id="profile-theme-preview" class="public-profile-main-preview">
                                <div class="profile-header-info-preview">
                                    <img id="profile-preview-photo" src="imgs/default-avatar.png" alt="Foto do Perfil">
                                    <div class="profile-name-details-preview">
                                        <h2 id="profile-preview-displayName">Seu Nome Aqui</h2>
                                        <p id="profile-preview-pronouns" class="profile-pronouns-preview">Seus Pronomes</p>
                                    </div>
                                </div>
                                <div class="profile-description-section-preview">
                                    <h3>Sobre Mim</h3>
                                    <p id="profile-preview-description">Sua bio apareceria aqui...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="section-jogos" class="profile-section">
                        <h2>Meus Jogos do Scratch</h2>
                        <div class="add-scratch-project-form">
                            <div class="form-group">
                                <label for="scratch-project-link-input">Link do Projeto Scratch:</label>
                                <input type="url" id="scratch-project-link-input" placeholder="https://scratch.mit.edu/projects/ID_DO_PROJETO/" required>
                            </div>
                            <div class="form-group">
                                <label for="scratch-project-title-input">Título Personalizado:</label>
                                <input type="text" id="scratch-project-title-input" placeholder="Como você quer chamar este projeto?" required>
                            </div>
                            <div class="form-group">
                                <label for="scratch-project-desc-input">Descrição Personalizada:</label>
                                <textarea id="scratch-project-desc-input" rows="3" placeholder="Descreva brevemente seu projeto aqui." required></textarea>
                            </div>
                            <button id="add-scratch-project-button">Adicionar Projeto</button>
                            <div id="scratch-project-message" class="form-message"></div>
                        </div>

                        <hr style="margin: 30px 0; border-color: #444;">

                        <h3>Projetos Adicionados:</h3>
                        <div id="scratch-projects-loading" style="display: none; text-align: center; padding: 15px;">Carregando projetos...</div>
                        <ul id="scratch-projects-list" class="scratch-projects-list-container">
                            <li class="list-placeholder" id="scratch-projects-empty-message" style="display: none;">Nenhum projeto adicionado ainda.</li>
                        </ul>
                    </div>
                    </section>
            </div>
        </main>
        <footer>
            <p>&copy; <span id="currentYear"></span> David's Farm. Todos os direitos reservados.</p>
        </footer>
    </div>

    <div id="custom-popup-overlay" class="custom-popup-overlay">
        <div id="custom-popup" class="custom-popup">
            <button id="custom-popup-close" class="custom-popup-close-btn">&times;</button>
            <div id="custom-popup-content" class="custom-popup-content">
                </div>
        </div>
    </div>

    <script type="module" src="profile-script.js"></script>

    <script>
        if (window.location.pathname.endsWith("profile.html")) {
            window.history.replaceState(null, "", "/settings");
        }
    </script>
</body>
</html>